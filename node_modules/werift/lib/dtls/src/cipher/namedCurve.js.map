{"version":3,"file":"namedCurve.js","sourceRoot":"","sources":["../../../../../dtls/src/cipher/namedCurve.ts"],"names":[],"mappings":";;;;;;AAAA,0DAA6B;AAE7B,mCAAoE;AACpE,6BAAmC;AAQnC,SAAgB,eAAe,CAC7B,UAAgC;IAEhC,QAAQ,UAAU,EAAE,CAAC;QACnB,KAAK,2BAAmB,CAAC,YAAY,CAAC,CAAC,CAAC;YACtC,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,IAAA,gBAAW,GAAE,CAAC;YAEhD,OAAO;gBACL,KAAK,EAAE,UAAU;gBACjB,UAAU;gBACV,SAAS;aACV,CAAC;QACJ,CAAC;QACD,KAAK,2BAAmB,CAAC,SAAS,CAAC,CAAC,CAAC;YACnC,MAAM,IAAI,GAAG,mBAAI,CAAC,GAAG,CAAC,OAAO,EAAE,CAAC;YAEhC,OAAO;gBACL,KAAK,EAAE,UAAU;gBACjB,UAAU,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;gBAC9C,SAAS,EAAE,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC;aAC9C,CAAC;QACJ,CAAC;QACD;YACE,MAAM,IAAI,KAAK,EAAE,CAAC;IACtB,CAAC;AACH,CAAC;AAzBD,0CAyBC","sourcesContent":["import nacl from \"tweetnacl\";\n\nimport { NamedCurveAlgorithm, NamedCurveAlgorithms } from \"./const\";\nimport { p256Keypair } from \"./ec\";\n\nexport interface NamedCurveKeyPair {\n  curve: NamedCurveAlgorithms;\n  publicKey: Buffer;\n  privateKey: Buffer;\n}\n\nexport function generateKeyPair(\n  namedCurve: NamedCurveAlgorithms,\n): NamedCurveKeyPair {\n  switch (namedCurve) {\n    case NamedCurveAlgorithm.secp256r1_23: {\n      const { privateKey, publicKey } = p256Keypair();\n\n      return {\n        curve: namedCurve,\n        privateKey,\n        publicKey,\n      };\n    }\n    case NamedCurveAlgorithm.x25519_29: {\n      const keys = nacl.box.keyPair();\n\n      return {\n        curve: namedCurve,\n        privateKey: Buffer.from(keys.secretKey.buffer),\n        publicKey: Buffer.from(keys.publicKey.buffer),\n      };\n    }\n    default:\n      throw new Error();\n  }\n}\n"]}